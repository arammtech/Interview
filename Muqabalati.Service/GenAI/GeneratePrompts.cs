using Muqabalati.Service.DTOs;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Muqabalati.Service.GenAI
{
    public static class GeneratePrompts
    {
        public static string GenerateReportPrompt(List<AnswerModel> answers, string[] questions)
        {
            return $@"
يرجى تحليل البيانات التالية المستندة إلى مقابلة حقيقية، وإرجاع النتائج بالتنسيق التالي:

<تقييم>
1. [عدد الإجابات الصحيحة (int) فقط]
2. [عدد الإجابات الخاطئة (int) فقط]
3. [نسبة النجاح (int) فقط]
4. <توصيات>
   <توصية>
      <نص>
      [نص التوصية المحددة لتحسين الأداء]
      </نص>
      <مصدر>
      [رابط المصدر المستخدم في إعداد التوصية، أو قيمة فارغة إذا لم يوجد مصدر]
      </مصدر>
   </توصية>
   [يمكن إضافة توصيات إضافية بنفس التنسيق]
</توصيات>
</تقييم>

بيانات المقابلة:
{PrintQuestionsAndAnswers(questions, answers)}
";
        }

        public static string GenerateIntroPrompt(
                  string applicantName,
                  string interviewerName,
                  string topic,
                  string tone,
                  string level,
                  string department,
                  string interviewLanguage)
        {
            return $@"
                                  صِغ تحية ودية تُستخدم في بداية مقابلة مع متقدم. يجب أن تتضمن التحية:

                * الترحيب بالمتقدم بشكل لائق.

                * تعريف النظام أو الشخص الذي يجري المقابلة.

                * تقديم توجيهات بسيطة ومشجعة حول كيفية الإجابة.


                * إخباره بأن لديه وقتًا معينًا سيظهر أمامه للإجابة على كل سؤال. 

                * إخباره بأن لديه  ازرار  في الشاشة لتساعده لاعادة السؤال او للتوضيح او الانتقال الى السؤال التالي بصياغة ودية

                * اخبرة 'الان  المقابلة ستبدا' بصياغة ودية .



                تفاصيل السياق:

                * اللغة: {interviewLanguage}

                * اللهجة: {tone}

                * اسم المتقدم: {applicantName}

                * اسم المحاور: {interviewerName}

                * الموضوع: {topic}

                * المستوى المطلوب: {level}

                * القسم: {department}



                النص يجب أن يكون:
                * الحفاظ على أسلوب ودي ومهني.
                * واضحًا ومباشرًا.
                * خاليًا من أي رموز أو تعليمات تحتاج إلى معالجة و  خاليا من علامات النحو وغيرها من العلامات التنصيص او النقاط او الفواصل او بدء سطر جديد
                * جاهزًا للاستخدام فورًا مع Web Speech AI.
";
        }


        public static string GenerateConclusionPrompt(
            string applicantName,
            string tone,
            string interviewLanguage)
        {
            return $@"
                صِغ خاتمة ودية تُستخدم لإنهاء مقابلة مع متقدم. يجب أن تتضمن الخاتمة:

                * شكر المتقدم باسمه ({applicantName}) على وقته وجهوده أثناء المقابلة.
                * الإشارة إلى أنه سيتم نقله إلى صفحة النتائج خلال ثوانٍ قليلة، حيث يمكنه الاطلاع على تقييمه النهائي.
                * الحفاظ على أسلوب ودي ومشجع لإنهاء المقابلة بانطباع إيجابي.
                * استخدام اللهجة: {tone}.
                                تفاصيل السياق:

                * اللغة: {interviewLanguage}

                * اللهجة: {tone}

                * اسم المتقدم: {applicantName}


                النص يجب أن يكون:
                * الحفاظ على أسلوب ودي ومهني.
                * واضحًا ومباشرًا.
                * خاليًا من أي رموز أو تعليمات تحتاج إلى معالجة و  خاليا من علامات النحو وغيرها من العلامات التنصيص او النقاط او الفواصل او بدء سطر جديد
                * جاهزًا للاستخدام فورًا مع Web Speech AI.
    ";
        }

        public static string PrintQuestionsAndAnswers(string[] questions, List<AnswerModel> answers)
        {
            if (questions.Length != answers.Count)
            {
                throw new ArgumentException("عدد الأسئلة يجب أن يتطابق مع عدد الإجابات.");
            }

            var result = new StringBuilder();

            for (int i = 0; i < questions.Length; i++)
            {
                result.AppendLine($"السؤال {i + 1}: {questions[i]}");
                result.AppendLine($"الإجابة: {answers[i].Answer}");
                result.AppendLine(); // مسافة بين كل سؤال وإجابته
            }

            return result.ToString();
        }


        public static string GenerateQuestionPrompt(
          int questionNum,
          string topic,
          string level,
          string department,
          string tone,
          string terminologyLanguage,
          string interviewLanguage)
        {
            return $@"
                    صِغ مجموعة من {questionNum} أسئلة موجهة إلى متقدم في مقابلة. يجب أن تتضمن ما يلي:

                    1. إضافة كلمة تمهيدية تربط كل سؤال بالسؤال السابق 
                       (مثل: ""وبعد ذلك، دعنا ننتقل إلى..."" أو ""في نفس السياق، سأسأل...""أو ""السؤال الاول هو"" أو ""بالإضافة إلى ذلك..."").  
                       *يرجى تجنب استخدام كلمات أو عبارات تحتوي على إجابات إيجابية أو موافقة، مثل: ""طيب دلوقتي بعد ما اتكلمنا عن خبرتك السابقة"" أو أي كلمة تربط الحديث بخبرة معينة قم بذكر رقم السؤال في البداية مع ذكر كلمة الربط ""السؤال الاول هو"".*

                    2. صياغة السؤال الأساسي بدقة ووضوح.

                    3. إعادة صياغة للسؤال باستخدام كلمات مختلفة مع الحفاظ على معناه.  
                       *يُفضل إضافة أمثلة توضيحية إذا كان ذلك مناسبًا.*

                    4. تقديم تفسير أو توضيح للسؤال لمساعدة المتقدم على فهم المطلوب.  
                       *يُفضل إضافة أمثلة عملية إذا كانت متاحة.*

                    5. تقدير الوقت المطلوب للإجابة على السؤال بالدقائق.

            متطلبات الأسئلة:

                        * الأسئلة يجب أن تكون واضحة ومباشرة.
                        * ذات صلة بالسياق التالي:
                          * الموضوع: {topic}.
                          * اللغة: {interviewLanguage}.
                          * المستوى المطلوب: {level}.
                          * القسم: {department}.
                        * مكتوبة بلهجة {tone} مع استخدام المصطلحات التقنية باللغة {terminologyLanguage}.
                        * يجب أن تتبع الأسئلة التنسيق التالي:
                          <سؤال>
                          1. [كلمة الربط]
                          2. [السؤال الأصلي لاتقم باضافة نقط او فواصل في النص]
                          3. [إعادة الصياغة مع أمثلة إذا لزم الأمر  لاتقم باضافة نقط او فواصل في النص]
                          4. [ التوضيح مع أمثلة عملية إذا امكن  لاتقم باضافة نقط او فواصل في النص ]
                          5. [الوقت المحتمل للإجابة بالدقائق اعد فقط الرقم لكي يمكنني تحولية الى int]
                          </سؤال>

                      النص المطلوب يجب أن يلتزم بالمعايير التالية:

1. **وضوح النص ومباشرته:** 
   - يجب أن يكون النص بسيطًا وخاليًا من التعقيد.

2. **خلو النص من الرموز والعلامات غير الضرورية:**
   - لا يُسمح باستخدام علامات التنصيص مثل: ""` أو '""'"".
   - يجب تجنب النقاط الزائدة أو أي رموز أخرى او علامات النحو مثل الفاصلة وغيرها.

3. **التنسيق المعتمد:**
   - النص يجب أن يلتزم بالشكل التالي فقط:
     ```
     <سؤال>
     1. [كلمة الربط]
     2. [السؤال الأصلي]
     3. [إعادة الصياغة مع أمثلة إذا لزم الأمر]
     4. [التوضيح مع أمثلة عملية إذا أمكن]
     5. [الوقت المحتمل للإجابة بالدقائق اعد فقط الرقم لكي يمكنني تحويله إلى int]
     </سؤال>
     ```

4. **سهولة الاستخدام:** 
   - يجب أن يكون النص جاهزًا للاستخدام الفوري دون الحاجة إلى أي معالجة إضافية.

5. **استثناءات التنسيق:**
   - الاستثناءات الوحيدة المسموح بها هي تنسيقات الفقرات والعناصر داخل إطار: `<سؤال>` كما هو محدد أعلاه.

النص الناتج عن هذه المعايير سيكون ملائمًا لأي تطبيق تقني دون الحاجة إلى معالجة إضافية، وسيسهل العمل معه بشكل مباشر.
                
                        لا تحذف هذا الفورمات لكي استطيع فصل الاسئلة مع اجزاءها او الفواصل. 
                        النص يجب أن يكون جاهزًا للاستخدام فورًا مع Web Speech AI.
                        ";
        }

    }
}
